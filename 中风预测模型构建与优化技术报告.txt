================================================================================
            中风预测模型构建与优化技术报告 (学术论文参考)
================================================================================

本报告详细阐述了针对高血压老年人群中风预测模型的构建、优化及评估的全流程。报告内容结合了代码实现的逻辑，涵盖了数据处理、不平衡处理、超参数调优、概率校准及临床价值评估等关键步骤。

1. 实验环境与数据基础
--------------------------------------------------------------------------------
- 数据源：elderly_hypertension_60plus_standardized.xlsx
- 特征选择 (Selected Features)：
    - Dyslipidemia (血脂异常)
    - PHR (脉率)
    - Uric_acid (尿酸)
    - MCV (平均红细胞体积)
    - Exercise (运动情况)
    - Age (年龄)
    - AIP (动脉粥样硬化指数)
- 目标变量：Stroke (中风患病情况)
- 数据划分：训练集 (70%)，测试集 (30%)，采用分层抽样 (Stratified Split) 以保持类别比例。

2. 类别不平衡处理 (SMOTE)
--------------------------------------------------------------------------------
由于中风事件在人群中属于少数类（患病率较低），模型容易偏向多数类。
- 技术手段：SMOTE (Synthetic Minority Over-sampling Technique)。
- 实现逻辑：
    - 在训练过程中，通过 `imblearn.pipeline.Pipeline` 将 SMOTE 与分类器集成。
    - 仅在训练集的交叉验证环节中进行过采样，确保测试集和验证集始终保持原始分布，避免数据泄露。
    - SMOTE 通过在少数类样本及其邻居之间进行线性插值，合成新的少数类样本，从而平衡类别权重。

3. 自动化超参数调优 (Randomized Search)
--------------------------------------------------------------------------------
为了挖掘各算法的最优性能，本研究采用了随机搜索策略。
- 技术手段：RandomizedSearchCV。
- 核心配置：
    - 搜索空间：为 7 种模型（随机森林、XGBoost、SVM、kNN、Gradient Boosting、AdaBoost、神经网络）定义了广泛的参数分布。
    - 评估指标：ROC-AUC (Receiver Operating Characteristic - Area Under Curve)。
    - 交叉验证：5折分层交叉验证 (5-Fold Stratified CV)。
    - 迭代次数：每个模型进行 50 次随机采样。
- 逻辑优势：相比于网格搜索 (Grid Search)，随机搜索在较大的参数空间内能以更低的计算成本找到近似最优解，且能更有效地处理对结果影响较大的关键参数。

4. 概率校准 (Isotonic Calibration)
--------------------------------------------------------------------------------
机器学习模型（特别是集成学习和支持向量机）输出的原始概率往往不代表真实的风险概率（即模型可能“过度自信”或“信心不足”）。
- 技术手段：Isotonic Regression (保序回归)。
- 实现逻辑：
    - 使用 `CalibratedClassifierCV` 封装已调优的模型。
    - 采用 `method='isotonic'`，通过非参数方法对模型输出的概率进行映射，使其更接近真实的观察频率。
    - 校准评估：通过校准曲线 (Calibration Curve) 和 Brier 分数进行验证。Brier 分数越低，代表校准后的概率预测越准确。

5. 临床决策分析 (DCA) 与临床影响曲线 (CIC)
--------------------------------------------------------------------------------
除了传统的准确率和 AUC，本研究重点评估了模型的临床应用价值。
- 决策曲线分析 (DCA)：
    - 计算净获益 (Net Benefit)：NB = (TP/N) - (FP/N) * (Pt/(1-Pt))，其中 Pt 为阈值概率。
    - 逻辑：通过比较模型曲线与 "Treat All" 和 "Treat None" 两条极端曲线，确定模型能提供正向净获益的阈值范围。
- 临床影响曲线 (CIC)：
    - 展示在不同阈值下，模型识别出的“高风险”人数与其中真正的“中风”人数的对比。
    - 逻辑：直观量化模型在实际临床筛查中带来的成本效益比，例如每 1000 人中能准确识别多少潜在中风患者。

6. 总结
--------------------------------------------------------------------------------
本研究通过 [Pipeline](file:///d:/中风指标/hyperparameter_optimization_random_search.py) 实现了从 SMOTE 平衡、超参数调优到概率校准的端到端自动化流程。最终生成的 [超参数优化结果.json](file:///d:/中风指标/随机搜索优化结果/超参数优化结果.json) 为后续的临床价值评估奠定了坚实的基础。校准后的模型在保持高 AUC 的同时，显著提升了风险预测的可靠性。

================================================================================
报告生成时间：2026-02-11
报告生成工具：Trae AI Assistant
================================================================================
