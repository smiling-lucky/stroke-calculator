
================================================================================
                    中风风险因素研究数据清洗流程报告
================================================================================

报告生成时间: 2026年2月1日
原始数据文件: wave2026.02.01.xlsx
最终数据文件: elderly_hypertension_60plus_imputed.xlsx

================================================================================
一、原始数据概况
================================================================================

1.1 基本信息
------------
- 原始数据文件: wave2026.02.01.xlsx
- 原始样本量: 17,708 人
- 原始变量数: 54 个
- 数据类型: 纵向队列研究数据

1.2 原始变量列表（54个）
------------------------
人口学特征:
  - ID, Wave, Age, Education, Gender, Marry, Rural

生活方式:
  - Exercise, Alcohol_consumption, Smoken

人体测量:
  - Height, Weight, Waist, BMI

疾病史:
  - Hypertension, Diabetes_mellitus, Cancre, Lunge, Hearte, Stroke,
    Dyslipidemia, Livere, Kidneye

血压指标:
  - SBP, DBP, PP, PHR

生化指标:
  - Fasting, Blood_glucose, WBC, MCV, PLT, BUN, Scr, TC, TG, HDL-C,
    LDL-C, CRP, HbA1c, Uric_acid, Hemoglobin

复合指标:
  - eGFRabdiff, eGFRrediff, Tyg, Tyg_bmi, AIP, CTI, CMI

随访数据:
  - Hypertension.1, Diabetes_mellitus.1, Follow_time, Event, Sleep

================================================================================
二、数据清洗流程详解
================================================================================

步骤1: 删除基础变量，保留复合变量
----------------------------------
操作时间: 第1阶段
删除变量（14个）:
  - 人体测量: Height, Weight, Waist
  - 血压: SBP, DBP
  - 血脂: TC, TG, HDL-C, LDL-C
  - 血糖: Fasting, Blood_glucose, HbA1c
  - 肾功能: Scr, BUN

保留复合变量:
  - BMI (体重指数)
  - PP (脉压)
  - PHR (脉压心率比)
  - Tyg (甘油三酯-葡萄糖指数)
  - Tyg_bmi (TyG-BMI指数)
  - AIP (动脉粥样硬化指数)
  - CTI (心脏代谢指数)
  - CMI (心脏代谢指数)
  - eGFRabdiff (基于Scr的eGFR)
  - eGFRrediff (基于CysC的eGFR)

结果: 17,708 行 × 40 列

步骤2: 删除部分复合变量
-----------------------
操作时间: 第2阶段
删除变量（3个）:
  - CMI
  - Tyg_bmi
  - eGFRrediff

结果: 17,708 行 × 37 列

步骤3: 删除PP变量
-----------------
操作时间: 第3阶段
删除变量（1个）:
  - PP (脉压)

结果: 17,708 行 × 36 列

步骤4: 删除其他变量
-------------------
操作时间: 第4阶段
删除变量（6个）:
  - Rural (城乡)
  - Cancre (癌症)
  - Lunge (肺部疾病)
  - PLT (血小板)
  - Hypertension (高血压)
  - Diabetes_mellitus (糖尿病)

结果: 17,708 行 × 30 列

步骤5: 变量重命名
-----------------
操作时间: 第5阶段
重命名:
  - Hypertension.1 → Hypertension
  - Diabetes_mellitus.1 → Diabetes

结果: 变量名更规范

步骤6: 数据清洗（行筛选）
--------------------------
操作时间: 第6阶段
清洗条件:
  1. 删除 Kidneye = 1 的记录（肾病患者）
  2. 删除 Age < 45 岁的记录
  3. 删除 Stroke 字段存在缺失值的记录

清洗结果:
  - 原始记录数: 17,708
  - Kidneye=1 删除: 979 条
  - Age<45 删除: 497 条
  - Stroke缺失 删除: 167 条
  - 最终保留: 15,932 条 (89.97%)

结果: 15,932 行 × 30 列

步骤7: 删除最后两列
-------------------
操作时间: 第7阶段
删除变量（2个）:
  - Follow_time (随访时间)
  - Event (事件)

结果: 15,932 行 × 28 列

步骤8: 筛选60岁以上高血压人群
------------------------------
操作时间: 第8阶段
筛选条件: Age ≥ 60 且 Hypertension = 1

筛选结果:
  - 筛选前: 15,932 人
  - 筛选后: 4,134 人 (26.0%)
  - 年龄范围: 60-101 岁
  - 平均年龄: 69.1 岁
  - 男性比例: 46.8%
  - 中风患病率: 6.2%

结果: 4,134 行 × 30 列

步骤9: 删除最后两列
-------------------
操作时间: 第9阶段
删除变量（2个）:
  - Follow_time (随访时间)
  - Event (事件)

结果: 4,134 行 × 28 列

步骤10: 重命名和删除变量
------------------------
操作时间: 第10阶段
重命名:
  - Hemoglobin → Hb

删除变量（2个）:
  - Kidneye (肾病)
  - Wave (波次)

结果: 4,134 行 × 26 列

步骤11: 多重插补
----------------
操作时间: 第11阶段
插补方法: IterativeImputer (基于RandomForest)
参数设置:
  - 估计器: RandomForestRegressor
  - 树的数量: 10
  - 最大迭代次数: 10
  - 随机种子: 42

插补前缺失情况（21个变量有缺失）:
 高缺失变量(>30%):
   - Exercise: 2,458 (59.46%)
   - eGFRabdiff: 1,685 (40.76%)
   - PHR: 1,320 (31.93%)
   - Hb: 1,290 (31.20%)
   - MCV: 1,290 (31.20%)
   - WBC: 1,291 (31.23%)
   - CTI: 1,260 (30.48%)
   - Tyg: 1,260 (30.48%)
   - AIP: 1,260 (30.48%)
   - CRP: 1,256 (30.38%)
   - Uric_acid: 1,256 (30.38%)

 中等缺失变量(5-20%):
   - BMI: 609 (14.73%)
   - Sleep: 249 (6.02%)

 低缺失变量(<5%):
   - Smoken: 84 (2.03%)
   - Dyslipidemia: 78 (1.89%)
   - Diabetes: 34 (0.82%)
   - Livere: 32 (0.77%)
   - Hearte: 30 (0.73%)
   - Stroke: 19 (0.46%)
   - Alcohol_consumption: 9 (0.22%)
   - Education: 6 (0.15%)

二分类变量处理:
  对以下变量进行四舍五入并限制在0-1:
   - Gender, Marry, Hearte, Stroke, Dyslipidemia, Livere
   - Alcohol_consumption, Smoken, Hypertension, Diabetes, Exercise

插补后结果:
  - 缺失值数量: 0
  - 所有二分类变量唯一值: [0, 1]

结果: 4,134 行 × 26 列，完整无缺失

================================================================================
三、最终数据集概况
================================================================================

3.1 基本信息
------------
- 文件名称: elderly_hypertension_60plus_imputed.xlsx
- 样本量: 4,134 人
- 变量数: 26 个
- 数据完整性: 100% (无缺失值)

3.2 人群特征
------------
- 年龄范围: 60-101 岁
- 平均年龄: 69.1 岁
- 性别分布: 男性 46.8%，女性 53.2%
- 中风患病率: 6.2%
- 糖尿病患病率: 约 14%

3.3 最终变量列表（26个）
------------------------
编号变量:
  01. ID - 编号

人口学特征:
  02. Age - 年龄
  03. Education - 教育程度
  04. Gender - 性别 (0=女, 1=男)
  05. Marry - 婚姻状况

生活方式:
  06. Exercise - 运动 (0/1)
  07. Alcohol_consumption - 饮酒 (0/1)
  08. Smoken - 吸烟 (0/1)
  09. Sleep - 睡眠时长

疾病史:
  10. Hearte - 心脏病 (0/1)
  11. Stroke - 中风 (0/1) [目标变量]
  12. Dyslipidemia - 血脂异常 (0/1)
  13. Livere - 肝病 (0/1)
  14. Hypertension - 高血压 (均为1)
  15. Diabetes - 糖尿病 (0/1)

人体测量:
  16. BMI - 体重指数

血常规指标:
  17. WBC - 白细胞
  18. MCV - 平均红细胞体积
  19. Hb - 血红蛋白

生化指标:
  20. CRP - C反应蛋白
  21. Uric_acid - 尿酸
  22. eGFRabdiff - 估算肾小球滤过率

复合指标:
  23. PHR - 脉压心率比
  24. Tyg - 甘油三酯-葡萄糖指数
  25. AIP - 动脉粥样硬化指数
  26. CTI - 心脏代谢指数

================================================================================
四、数据质量评估
================================================================================

4.1 缺失值处理效果
------------------
- 插补前总体缺失比例: 13.99%
- 插补后总体缺失比例: 0%
- 插补方法: 多重插补 (MICE)

4.2 二分类变量验证
------------------
所有二分类变量均严格限制为0或1:
  ✓ Gender: [0, 1]
  ✓ Marry: [0, 1]
  ✓ Hearte: [0, 1]
  ✓ Stroke: [0, 1]
  ✓ Dyslipidemia: [0, 1]
  ✓ Livere: [0, 1]
  ✓ Alcohol_consumption: [0, 1]
  ✓ Smoken: [0, 1]
  ✓ Diabetes: [0, 1]
  ✓ Exercise: [0, 1]

4.3 数据分布保持
----------------
插补前后均值变化较小，数据分布特征保持良好:
  - Exercise: 0.851 → 0.859 (变化 +0.008)
  - BMI: 24.312 → 24.329 (变化 +0.017)
  - WBC: 6.346 → 6.414 (变化 +0.068)

================================================================================
五、清洗流程总结
================================================================================

5.1 数据筛选流程
----------------
原始数据 (17,708)
  ↓ 删除基础变量，保留复合变量
中间数据 (17,708 × 40)
  ↓ 删除部分复合变量和特定变量
中间数据 (17,708 × 36)
  ↓ 行筛选 (Kidneye≠1, Age≥45, Stroke无缺失)
清洗后数据 (15,932)
  ↓ 筛选60岁以上高血压人群
目标人群数据 (4,134)
  ↓ 变量精简和重命名
最终数据 (4,134 × 26)
  ↓ 多重插补
完整数据 (4,134 × 26, 无缺失)

5.2 数据损失情况
----------------
- 原始样本: 17,708
- 最终样本: 4,134
- 保留比例: 23.3%
- 主要损失原因:
  1. 年龄限制 (<60岁): 约 60%
  2. 高血压筛选: 约 57% (原人群中)
  3. 其他清洗条件: 约 10%

5.3 数据质量提升
----------------
- 缺失值: 从 13.99% 降至 0%
- 数据一致性: 所有分类变量规范化
- 变量精简: 从 54 个减至 26 个，保留核心指标

================================================================================
六、建议与注意事项
================================================================================

6.1 数据使用建议
----------------
1. 本数据集适用于60岁以上高血压人群的中风风险因素研究
2. 由于筛选条件限制，结果外推至其他人群时需谨慎
3. 所有复合指标已基于原始变量计算，无需再次计算

6.2 分析注意事项
----------------
1. Hypertension变量全为1，在分析中可作为筛选条件而非预测变量
2. Stroke为目标变量，患病率为6.2%，属于不平衡数据
3. 多重插补后的数据保持了原始分布特征，可用于统计分析

6.3 后续分析建议
----------------
1. 可进行逻辑回归、随机森林等分类模型构建
2. 建议进行特征重要性分析，识别关键风险因素
3. 可考虑构建风险评分模型

================================================================================
七、文件清单
================================================================================

原始文件:
  - wave2026.02.01.xlsx (原始数据)

中间文件:
  - wave2026.02.01_removed.xlsx (变量筛选后)
  - wave2026.02.01_cleaned.xlsx (行清洗后)

最终文件:
  - elderly_hypertension_60plus.xlsx (筛选后未插补)
  - elderly_hypertension_60plus_imputed.xlsx (最终完整数据)

报告文件:
  - data_cleaning_report.txt (本报告)

================================================================================
报告结束
================================================================================
